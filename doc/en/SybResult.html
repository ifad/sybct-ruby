<html>
<head>
<TITLE>SybResult class</TITLE>
</head>
<body text="black" bgcolor="white">

<p align=right>
<a href="index.html">index</a>
</p>

<h1>SybResult</h1>

<ul>
  This class represents a Sybase result set, which is usually
generated by executing the <a href="SybSQL.html#sql">sql</a> method of
<a href="SybSQL.html">SybSQL</a>.
</ul>

<h3>Included Modules</h3>
<menu>
<li><a href="SybConstant.html">SybConstant</a><br>
</menu><br><p>

<h3>Class Method</h3>
<dl>
<dt><b>new(<var>restype</var>, <var>rowset</var>=nil)</b><br>
<dd>
  Rreturns a newly created result set object.
  <p>
  <b>Parameters:</b><br>
  <ul type=disc>
  <li><b><var>restype</var></b><br> 
     The parameter <b><var>restype</var></b> indicates the type of
    result. the following table lists the possible value of
   <b><var>restype</var></b>.
    <table border=1>
    <tr><td>CS_CMD_SUCCEED
        <td>The success of a command that returns no data
    <tr><td>CS_CMD_DONE
        <td>The results of a command have been completely processed.
    <tr><td>CS_CMD_FAIL
        <td>The server encountered an error while executing a command
    <tr><td>CS_ROW_RESULT
        <td>Regular row results
    <tr><td>CS_PARAM_RESULT
        <td>Parameter results
    <tr><td>CS_STATUS_RESULT
        <td>Stored procedure return status results.
    <tr><td>CS_COMPUTE_RESULT
        <td> Compute row results
    </table><br>
  These CS_XXX_XXXXX constants is defined in
 <a href="SybConstant.html">SybConstant</a> module.<p>
  <li><b><var>rowset</var></b><br>
     Sets row results.  
     <menu>
     <li>rowset[0] -- An array of column names.
     <li>rowset[1] -- Row datas as an array of array 
     </menu>
  </ul>
</dl>

<h3>Methods</h3>
<dl>
<dt><b>restype</b><br>
<dd>
  Returns result type (CS_ROW_RESULT, CS_CMD_FAIL etc. ).<p>

<dt><b>rows</b><br>
<dd>
  Returns row results as Array of Array.<p>
  If the result type is neither CS_ROW_RESULT,CS_PARAM_RESULT,
CS_STATUS_RESULT nor CS_COMPUTE_RESULT, then it returns <var>nil</var><p>

<dt><b>columns</b><br>
<dd>
  Returns an array of column names<p>

  If the result type is neither CS_ROW_RESULT nor CS_PARAM_RESULT,
  then it returns <var>nil</var><p>

<dt><b>nthrow( <var>nth</var>, <var>clm</var>=nil )</b><br>
<dd>
  <ul type=disc>
   <li>If <b><var>clm</var></b> was omitted,<br>
       It returns the <b><var>nth</var></b> row results array.<p>
   <li>If <b><var>clm</var></b> was specified to a kind of 
    Numeric object,<br>
       It returns a data value at the specified row number and column
         number.<br>
       <b><var>nth</var></b> signifies row number. 
         and , <b><var>clm</var></b> signifies column number.<p>
   <li>If <b><var>clm</var></b> was specified to a kind of 
     String object,<br>
       It returns a data value at the specified row number 
         and column name.<br>
       <b><var>nth</var></b> signifies row number. 
         and , <b><var>clm</var></b> signifies column name.<p>
  </ul>

  <b>Examples</b><br>
  <pre>
  ## exec sp_who ##
  query.sql("sp_who")
  
  ## gets the first row result ##
  res=query.top_row_result  # res is a SybResult object 

  ## print column names. ##
  print res.columns.join(','),"\n"
   -->
     spid,status,loginame,hostname,blk,dbname,cmd

  ## print row data ##
  res.rows.each{|r| print r.join(','), "\n"}
   -->
    1,running     ,sa          ,          ,0    ,master    ,SELECT          
    2,sleeping    ,,          ,0    ,master    ,NETWORK HANDLER 
    3,sleeping    ,,          ,0    ,master    ,DEADLOCK TUNE   
    4,sleeping    ,,          ,0    ,master    ,MIRROR HANDLER  
    5,sleeping    ,,          ,0    ,master    ,HOUSEKEEPER     
    6,sleeping    ,,          ,0    ,master    ,CHECKPOINT SLEEP

  ## using column number ##
  print res.nthrow(0,1),"\n"
   -->
    "running     "

  ## Using column name ##
  print res.nthrow(5,"cmd"),"\n"
   -->
    "CHECKPOINT SLEEP"
</pre>

<dt><b>tran_state</b><br>
<dd>
  Returns the current server transaction state.<p>
  <b>Returns:</b><br>
  <ul type=disc>
  <li> SybConstant::CS_TRAN_IN_PROGRESS<br>
    A transaction is progress.<br>
  <li> SybConstant::CS_TRAN_COMPLETED<br>
    The most recent transaction completed successfully.<br>
  <li> SybConstant::CS_TRAN_FAIL<br>
    The most recent transaction failed<br>
  <li> SybConstant::CS_TRAN_STMT_FAIL<br>
    The most recent transaction failed<br>
  <li> SybConstant::CS_TRAN_UNDEFINED<br>
    A transaction state is not defined.<br>
  </ul><p>

<dt><b>row_count</b><br>
<dd>
  Returns the number of rows affected by the command.<p>
<dl>

</body>
</html>
